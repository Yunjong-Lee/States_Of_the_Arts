---
date: 2024-03-23 16:25:38
layout: post
---

# [Dynamic Vital Sign estimation for Multiple Persons using mmWave technology]()

# 3. People detection
## 3.4. Implementation  

### 3.4.1 Input data format
알고리즘은 최대 4명의 좌표 목록을 반환합니다.
섹션 2.1.3 ~ 섹션 2.1.3에 설명된 내장 범위 FFT, 도플러 FFT 및 각도 FFT 구현을 사용합니다.
이러한 방법을 사용하면 2차원 히트맵을 생성할 수 있습니다. x축에는 방위각(각도) 방향의 모든 bin이 있고 y축에는 범위 방향의 모든 bin이 있습니다.
따라서 섹션 2.1에서 찾은 정보를 요약하면 범위 방향의 데이터는 range-FFT에서 나오고 방위각 방향의 정보는 angle-FFT에서 나옵니다.
각 저장소에는 해당 저장소의 에너지 수준에 대한 정보가 포함되어 있습니다. 즉, 해당 빈 위치에서 얼마나 많은 신호 반사가 관찰되었는지를 나타냅니다.

### 3.4.2 Noise removal
사람을 감지하려면 먼저 배경 소음을 제거해야 합니다.
소음이 적기 때문에 센서 앞에 있는 사람이 더 눈에 띄고 감지하기가 더 쉽습니다. 또한 신호 강도도 향상됩니다.
이 프로젝트의 경우 테스트는 한 위치에서 수행되므로 센서가 고정 위치에 있고 배경 변경이 없다고 가정할 수 있습니다.
각각의 새로운 배경에 대해 새로운 보정 라운드를 수행해야 합니다. 이 보정 중에 센서는 센서 앞의 공간을 스캔합니다.
그 순간 정지된 사람 외에는 다른 사람이나 물체가 센서를 바라보지 않는 것이 매우 중요합니다.
센서는 64번의 스캔을 수행하고 해당 스캔의 평균을 구합니다.
이 노이즈 맵은 장치에 저장되고 UART를 통해 컴퓨터로 반환됩니다.
이러한 방식으로 센서가 다시 시작될 때 컴퓨터는 다른 모든 매개변수와 함께 값을 보낼 수 있으며 교정 라운드를 다시 실행할 필요가 없습니다.
교정 데이터가 준비되면 들어오는 각 새 프레임에서 노이즈를 제거하는 데 사용할 수 있습니다.
이 노이즈 알고리즘은 전체 행이 과도하게 포화되는 현상도 수정합니다. 이러한 행은 그림 3.2a에서 명확하게 볼 수 있습니다.
잡음 보정과 잡음 보정 없음의 차이는 그림 3.2에서 확인할 수 있습니다.

### 3.4.3 Peak detection
이 알고리즘은 피크를 감지하여 작동합니다. 테스트 단계에서 프레임 안에 있는 사람의 최소 피크 높이가 얼마인지 결정되었습니다.
히트맵 저장소 하나의 최대 열은 32000입니다.
프레임 내 사람이 생성하는 최소 피크는 2000입니다.
이 숫자에는 단위가 없으며 단지 신호 강도를 측정한 것입니다. 0은 신호가 없고 32000은 관찰 가능한 최대 신호입니다.
이는 첫 번째 필터이며 임계값보다 높은 피크만 고려됩니다.
이 애플리케이션의 경우 각 사람이 약 0.5미터에서 1미터 간격으로 앉아 있다고 가정하므로 개인을 더 쉽게 감지할 수 있습니다.
이는 사람 감지 알고리즘의 그룹화 기능으로 변환됩니다.
발견된 각각의 새로운 피크에 대해, 새로운 피크의 0.5미터 이내에 다른 피크가 발견되었는지 확인합니다.
그러한 경우에는 크기가 가장 큰 피크가 목록에 추가됩니다.
결과적으로 각 사람이 0.5미터 떨어져 앉아 있는 경우 각 사람의 가장 큰 봉우리를 찾을 수 있습니다.
가장 큰 피크는 가장 높은 SNR 값을 갖는 정보를 제공하므로 다음 알고리즘이 가장 최적의 형태로 작동합니다. 반환 값은 1인당 하나의 Bin으로 구성된 하나 이상의 Bin 좌표가 포함된 배열입니다.
이 알고리즘은 64프레임마다 한 번씩 실행됩니다.
프로그램은 초당 약 10프레임을 처리하므로 6.4초마다 다른 사람 감지 라운드가 수행됩니다.
알고리즘은 계산하는 데 상대적으로 많은 시간이 걸리기 때문에 매 프레임마다 실행되지 않으며 전체 시스템이 이러한 방식으로 더 안정적입니다.
앞으로는 슬라이딩 윈도우를 구현하고 추적 기반으로 여러 프레임의 평균을 취하는 것이 가장 좋습니다.
이 프로젝트는 칩에 공간이 부족하고 추가 계산을 할 시간이 없어 구현하지 못했습니다. 이는 소프트웨어 최적화를 통해 해결될 수 있습니다.

### 3.4.4 Result

